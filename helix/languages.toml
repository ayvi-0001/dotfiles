# https://docs.helix-editor.com/languages.html
# https://github.com/helix-editor/helix/blob/master/languages.toml
# https://github.com/helix-editor/helix/wiki/Language-Server-Configurations

[language-server.bash-language-server]
command = "bash-language-server"
args    = ["start"]

[language-server.rust-analyzer]
command = "rust-analyzer"

[language-server.pylyzer]
command = "pylyzer"
args    = ["--server"]

[language-server.ruff]
command     = "ruff"
args        = ["server", "-q", "--preview"]
environment = { "RUFF_TRACE" = "messages" }

[language-server.ruff.config.settings]
format.preview = true
lint.preview   = true
logLevel       = "debug"
run            = "onSave"

[language-server.pylsp]
command = "pylsp"

[language-server.pylsp.config.pylsp]
plugins.black.enabled           = false
plugins.isort.enabled           = true
plugins.pyflakes.enabled        = true
plugins.pylint.enabled          = true
plugins.pyls_mypy.enabled       = false
plugins.pyls_mypy.live_mode     = false
plugins.pylsp_mypy.dmypy        = false
plugins.rope_autoimport.enabled = false
plugins.ruff.enabled            = true
plugins.ruff.formatEnabled      = true
plugins.ruff.preview            = true

[language-server.sql-language-server]
command = "sql-language-server"
args    = ["up", "--method", "stdio"]


[[language]]
name             = "python"
auto-format      = true
shebangs         = ["python", "uv"]
language-servers = ["ruff", "basedpyright"] # "pylsp", "pylyzer"
indent           = { tab-width = 4, unit = "    " }
formatter        = { command = "ruff", args = ["format", "-"] }


[[language]]
name                          = "rust"
shebangs                      = ["rust-script", "cargo"]
auto-format                   = true
comment-tokens                = ["//", "///", "//!"]
language-servers              = ["rust-analyzer"]
indent                        = { tab-width = 4, unit = "    " }
persistent-diagnostic-sources = ["rustc", "clippy"]
formatter                     = { command = "rustfmt" }

[[grammar]]
name       = "rust"
source.git = "https://github.com/tree-sitter/tree-sitter-rust"
source.rev = "0431a2c60828731f27491ee9fdefe25e250ce9c9"


[[language]]
name        = "xit"
auto-format = true
indent      = { tab-width = 4, unit = "    " }
formatter   = { command = "bash", args = ["-c", "xit-sort -"] } # custom script in ~/bin/

[[grammar]]
name       = "xit"
source.git = "https://github.com/synaptiko/tree-sitter-xit"
source.rev = "a4fad351bfa5efdcb379b40c36671413fbe9caac"


[[language]]
name        = "csv"
file-types  = ["csv"]
scope       = "source.csv"
auto-format = true
formatter   = { command = "bash", args = ["-c", "column -t -s, -o, <&0"] }


[[grammar]]
name       = "bash"
source.git = "https://github.com/tree-sitter/tree-sitter-bash"
source.rev = "487734f87fd87118028a65a4599352fa99c9cde8"


[[language]]
name             = "markdown"
soft-wrap.enable = true
text-width       = 200

[[grammar]]
name           = "markdown"
source.git     = "https://github.com/tree-sitter-grammars/tree-sitter-markdown"
source.rev     = "192407ab5a24bfc24f13332979b5e7967518754a"
source.subpath = "tree-sitter-markdown"

[[grammar]]
name           = "markdown_inline"
source.git     = "https://github.com/tree-sitter-grammars/tree-sitter-markdown"
source.rev     = "192407ab5a24bfc24f13332979b5e7967518754a"
source.subpath = "tree-sitter-markdown-inline"


[[grammar]]
name       = "mermaid"
source.git = "https://github.com/monaqa/tree-sitter-mermaid"
source.rev = "90ae195b31933ceb9d079abfa8a3ad0a36fee4cc"


[[language]]
name             = "sql"
file-types       = ["sql", "dsql", "sqlx"]
indent           = { tab-width = 2, unit = "    " }
auto-format      = true
language-servers = ["sql-language-server"]
formatter        = { command = "sqlfluff", args = ["fix -"] }

[[grammar]]
name       = "sql"
source.git = "https://github.com/DerekStride/tree-sitter-sql"
source.rev = "8a4578bd200fd1ed73e8cbecbe3c5053a4bcf2f8"


[[language]]
name             = "toml"
language-servers = ["taplo"]
indent           = { tab-width = 2, unit = "  " }
auto-format      = true
# formatter        = { command = "taplo", args = ["format", "-"] }
formatter.command = "taplo-helix-fmt" # custom script in ~/bin/
# https://github.com/helix-editor/helix/issues/3596
